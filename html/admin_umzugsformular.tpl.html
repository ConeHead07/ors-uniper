{assign var="laenderCsv" value=$ASConf.land.size|substr:1:-1}
{assign var="laenderLst" value="','"|explode:$laenderCsv}

{assign var="fillCustomerInput" value="1"}
{if $cmd eq "anbieten" and empty($AID)}
   {assign var="fillCustomerInput" value="0"}
{/if}

{literal}
<link href="{WebRoot}css/SelBox.easy.css?%assetsRefreshId%" rel="STYLESHEET" type="text/css" />
<script src="{WebRoot}js/FbAjaxUpdater.js?%assetsRefreshId%" type="text/javascript"></script>
<script src="{WebRoot}js/PageInfo.js?%assetsRefreshId%" type="text/javascript"></script>
<script src="{WebRoot}js/ObjectHandler.js?%assetsRefreshId%" type="text/javascript"></script>
<script src="{WebRoot}js/SelBox.easy.js?%assetsRefreshId%" type="text/javascript"></script>
<script src="{WebRoot}js/umzugsformular.easy.js?%assetsRefreshId%" type="text/javascript"></script>
<script src="{WebRoot}js/geraeteumzug.easy.js?%assetsRefreshId%" type="text/javascript"></script>
<script src="{WebRoot}js/dienstleister.js?%assetsRefreshId%" type="text/javascript"></script>
{/literal}
<script>
  {literal}
optionsUmzugsarten.push({value:"Datenpflege", content:"Datenpflege"});
{/literal}
</script>

<div id="SysInfoBox"></div>

<link rel="stylesheet" type="text/css" href="{literal}{WebRoot}{/literal}css/umzugsformular.css?%assetsRefreshId%">

{include file="admin_antraege_tabs.html" cat="auftrag" aid=$AS.aid s="aantraege" allusers=1}
<!-- MODUL UEBERSCHRIFTENBOX 109099 BEGIN --> 
<div class="divModuleBasic padding12px width5Col heightAuto colorContentMain">
  <div class="divInlay noMarginBottom borderTop"></div>
<div id="Umzugsantrag" data-html="html/admin/umzugsformular/tpl/html" class="divInlay">
<h2 style="margin:0;">Auftragsdaten</h2>
  <form action="umzugsantrag_speichern.php" name="frmUmzugsantrag" method="post" style="margin:0;padding:0;display:inline;">
<table class="form-table" border=1 cellspacing=1 cellpadding=1>
    <tr>
      <td class="label" style="padding:0;width:180px;"><label style="display:block;width:180px;">{$ASConf.service.label}</label></td>
      <td style="padding:0;width:250px;" class="options-onoff"><label class='{if $AS.service eq "Ja"}on{else}off{/if} active' style="width: 100%;box-sizing: border-box">{$AS.service}</label></td>
    </tr>
  {if !empty($AS.ref_aid)}
  <tr>
    <td class="label" style="padding:0;width:200px;height:auto;width:auto;"><label style="width:180px;">Bezieht sich auf:</label></td>
    <td style="padding:0;width:250px;"><a href="/?s=aantrag&id={$AS.ref_aid}">{$AS.ref_aid}</a></td>
  </tr>
  {/if}
  {if !empty($AS.reklamiert_von) or !empty($AS.reklamiert_am)}
  <tr>
    <td style="padding:0;"><label style="width:180px;">Reklamiert:</label></td>
    <td style="padding:0;" class="options-onoff"><label class="itxt itxt2col off active">{$AS.reklamiert_am} von {$AS.reklamiert_von}</label></td>
  </tr>
  {/if}
  {if !empty($AS.rueckholung_von) or !empty($AS.rueckholung_am)}
  <tr>
    <td style="padding:0;"><label style="width:180px;">RückholAuftrag:</label></td>
    <td style="padding:0;" class="options-onoff"><label class="itxt itxt2col off active">{$AS.rueckholung_am} von {$AS.rueckholung_von}</label></td>
  </tr>
  {/if}
  <tr>
    <td class="label" style="padding:0;width:200px;height:auto;width:auto;"><label for="termin" style="width:180px;">Liefertermin:</label></td>
    <td style="padding:0;width:250px;"><input id="termin" type="text" value='{$AS.umzugstermin|escape|date_format:"%d.%m.%Y"}'
    onfocus="showDtPicker(this)" name="AS[umzugstermin]" class="itxt itxt2col"></td>
  </tr>
  <tr>
    <td style="padding:0;height:auto;width:auto;"><label for="AS[Umzugszeit]" style="width:180px;">Uhrzeit:</label></td>
    <td style="padding:0;width:250px;"><input id="AS[Umzugszeit]" type="time" value='{$AS.umzugszeit|escape|substr:0:5}'
                                              id="umzugszeit" name="AS[umzugszeit]" class="itxt itxt2col"></td>
  </tr>
  <tr>
    <td style="padding:0;width:200px;height:auto;width:auto;"><label for="tour_kennung" style="width:180px;">Tour-Kennung/ID:</label></td>
    <td style="padding:0;width:250px;"><input
            id="tour_kennung" name="AS[tour_kennung]" type="text" value='{$AS.tour_kennung|escape}'
            class="itxt itxt2col jtooltip-local" rel="#infoTourkennung"></td>
  </tr>
  {if !empty($AS.tour_kennung)}
  <tr>
    <td style="padding:0;width:auto;"><label style="width:180px;">Tourzuweisung:</label></td>
    <td style="padding:0;width:auto;">
      <div class="itxt itxt2col">{$AS.tour_zugewiesen_am|date_format:"%d.%m.%y %H:%M"}, {$AS.tour_zugewiesen_von}</div>
    </td>
  </tr>
  {/if}
  <tr>
    <td style="padding:0;height:auto;width:auto;"><label style="width:180px;">Antragsdatum:</label></td>
    <td style="padding:0;width:auto;"><div  class="itxt itxt2col">{$AS.antragsdatum|escape|date_format:"%d.%m.%Y"}</div></td>
  </tr>

  <tr>
    <td style="padding:0;width:auto;"><label style="width:180px;">Best&auml;tigt / Avisiert:</label></td>
    <td style="padding:0;width:auto;" class="status_{$AS.genehmigt_br}" title="{$AS.bestaetigt}{if $AS.bestaetigt_am} am {$AS.bestaetigt_am|date_format:'%d.%m.%Y um %H:%M'} von {$AS.bestaetigt_von}{/if}">
      <div  class="itxt itxt2col"><img id="imgStatGen" src="images/status_{$AS.bestaetigt|lower}.png"><span id="txtStatGen">{$AS.bestaetigt}{if $AS.bestaetigt_am} am {$AS.bestaetigt_am|date_format:"%d.%m. um %H:%M"} von {$AS.bestaetigt_von}{/if}</span></div></td>
  </tr>

  <tr>
    <td style="padding:0;width:auto;"><label style="width:180px;">Abgeschlossen:</label></td>
    <td style="padding:0;width:auto;" class="status_{$AS.abgeschlossen}">
      <div  class="itxt itxt2col">
      <img id="imgStatAbg" src="images/status_{$AS.abgeschlossen|lower}.png"><span id="txtStatAbg">{if $AS.abgeschlossen ne "Init"} {$AS.abgeschlossen} am {$AS.abgeschlossen_am|date_format:"%d.%m.%Y %H:%M"} {$AS.abgeschlossen_von}{/if}</span></div></td>
  </tr>
  <tr>
    <td style="padding:0;"><label style="width:180px;">Aktueller Status:</label></td>
    <td style="padding:0;"><div class="itxt itxt2col">{if empty($AS.angeboten_am) and $AS.umzugsstatus|escape eq "genehmigt"}bestaetigt{else}{$AS.umzugsstatus|escape}{/if}</div></td>
  </tr>
  {if $AS.angeboten_von}
  <tr>
    <td style="padding:0;"><label style="width:180px;">Angeboten:</label></td>
    <td style="padding:0;"><div class="itxt itxt2col">{$AS.angeboten_am} von {$AS.angeboten_von}</div></td>
  </tr>
  {/if}
	<!-- SelBox_initLSDefault(initInputObj, initLSName, initMultiple, initLSSearchFields, initLSInputFields) -->
</table>
  <a href="%WebRoot%sites/umzugsblatt.php?id={$AS.aid}" style="display:none;" target="_Umzugsblatt{$AS.aid}"><img src="%WebRoot%images/printer.png" width="16" height="16" alt="">Umzugsblatt / Druckansicht</a>

    <div style="display:none">
      <div id="infoTourkennung">
        Wenn der Auftrag einer Tour in der Tourenplanung zugeordnet ist, hinterlegen Sie hier bitte die Tour-Nr.
      </div>
    </div>
  <img src="%WebRoot%images/printer.png" width="16" height="16" alt="">
  <a href="%WebRoot%sites/lieferschein.php?aid={$AS.aid}" target="_Lieferschein{$AS.aid}">Lieferschein</a>
  | <a href="%WebRoot%sites/lieferschein.php?aid={$AS.aid}&art=kommission" target="_Lieferschein{$AS.aid}">Kommissonierschein </a>
  | <a href="%WebRoot%sites/etiketten.php?aid={$AS.aid}" target="_Etiketten{$AS.aid}">Etiketten</a>
<br>
    {if !empty($AS.bemerkungen)}
    <div style="margin-top: 1.5rem">
      {if $AS.neue_bemerkungen_fuer_admin > 0}
      <div id="neueBemerkungenHintBox" style="text-align: right;">
        Es liegen <u>{$AS.neue_bemerkungen_fuer_admin}</u> neue Bemerkungen für Admins vor
       <button id="btnMarkAsRead" data-num="{$AS.neue_bemerkungen_fuer_admin|escape}" class="btn green btn-mark-reas" style="padding: 2px 5px 2px 5px;margin: 0 2px 0 0;">als gelesen markieren</button>
      </div>
      {/if}
      <table class="form-table" width="100%" border=1 cellspacing=1 cellpadding=1>
          <tr>
            <td> Bisherige Bemerkungen:</td>
            <td class="no-border"></td>
          </tr>
          <tr>
            <td colspan="2">
              <div id="BemerkungenHistorie" style="resize: vertical;overflow:auto;height:4rem">{$AS.bemerkungen|nl2br}</div>
            </td>
          </tr>
      </table>
    </div>
    {/if}

    {if !empty($AS.lieferhinweise)}
    <table class="form-table"  width="100%" border=1 cellspacing=1 cellpadding=1 style="margin-top: 1.5rem">
      <tr>
        <td style="padding:0;width:200px;height:auto;width:auto;"><label style="width:180px;">Lieferhinweise:</label></td>
        <td></td>
      </tr>
      <tr>
        <td colspan="2">
          <div id="LieferhinweiseContent" style="resize: vertical;overflow:auto;height:4rem">{$AS.lieferhinweise|nl2br}</div>
        </td>
      </tr>
    </table>
    {/if}

  <div  style="margin-top: 2rem">
<div style="float:left">
<h2 style="margin:0;">Lieferdaten </h2>
<input type="hidden" name="AS[aid]" value="{$AS.aid}">
<input type="hidden" name="AS[token]" value="{$AS.token}">
  <input type="hidden" value="{if $fillCustomerInput}{$AS.antragsteller_uid|escape}{/if}" name="AS[antragsteller_uid]">
<table class="form-table" >
  <tr>
      <td style="padding:0;"><label for="mitarbeiter" style="width:180px;">Vor{if $ASConf.vorname.required}<span class="required">*</span>{/if} &amp; Nachname<span class="right">{if $ASConf.name.required}<span class="required">*</span>{/if}</span></label></td>
    <td style="padding:0;width:250px;"><input type="text" readonly="true" value="{if $fillCustomerInput}{$AS.vorname|escape}{/if}" name="AS[vorname]" class="itxt itxt1col floatLeft"><input type="text" readonly="true" value="{if $fillCustomerInput}{$AS.name|escape}{/if}" name="AS[name]" class="itxt itxt1col floatRight" title="Name"></td>
  </tr>
  <tr>
    <td style="padding:0;"><label for="email" style="width:180px;">E-Mail<span class="right">{if $ASConf.email.required}<span class="required">*</span>{/if}</span></label></td>
    <td style="padding:0;"><input id="email" type="text" readonly="true" value="{if $fillCustomerInput}{$AS.email|escape}{/if}" name="AS[email]" class="itxt itxt2col" title="E-Mail"></td>
  </tr>
  <tr>
    <td style="padding:0;"><label for="fon" style="width:180px;">Telefon<span class="right">{if $ASConf.fon.required}<span class="required">*</span>{/if}</span></label></td>
    <td style="padding:0;"><input id="fon" type="text" value="{if $fillCustomerInput}{$AS.fon|escape}{/if}" name="AS[fon]" class="itxt itxt2col jtooltip" rel="%WebRoot%hilfetexte/antrag_fon.php"></td>
  </tr>
  <tr>
    <td style="padding:0;"><label for="as_kid" style="display:block;width:auto;">KID</label></td>
    <td style="padding:0;"><input type="text" id="as_kid" name="AS[personalnr]" readonly value="{if $fillCustomerInput and !empty($AS)}{$AS.personalnr|escape}{/if}" class="itxt itxt2col" ></td>
  </tr>
</table>
  {if empty($fillCustomerInput)}
  <button id="btnSelectCustomer" class="btn green" type="button"> Kunde auswählen </button>
  {/if}

  <div style="margin-top:2rem;"><h2 style="margin:0;">Lieferadresse <i class="geo-address"
                                                    data-address="{$AS.strasse|escape},{$AS.plz|escape}+{$AS.ort|escape},{$AS.land|escape}"
                                                    data-geo-strasse="{$AS.strasse|escape}"
                                                    data-geo-plz="{$AS.plz|escape}"
                                                    geo-geo-ort="{$AS.ort|escape}"
                                                    data-geo-land="{$AS.land|escape}"></i></h2></div>
  <script>
    $(function() {
      $("i.geo-address[data-address]").each(function() {
        var gmapUrl = "https://www.google.com/maps/dir/?api=1&travelmode=driving&destination=";
        var query = encodeURIComponent( $(this).data("address") );
        // https://www.google.com/maps/dir/?api=1&destination=Mainzer+Straße+97,65189+Wiesbaden,Deutschland&travelmode=driving
        $(this).wrap( $("<a/>").attr({
          href: gmapUrl + query,
          target: "gmap",
          title: "Lieferadresse in Gmap anzeigen"
        }) ).addClass("marker icon");
      });
    });
  </script>
  <table class="form-table" >
  <tr>
    <td style="padding:0;">
      <label for="as_strasse" style="display:block;width:180px;">Stra&szlig;e &amp; Nr<span class="right">{if $ASConf.strasse.required}<span class="required">*</span>{/if}</span></label>
    </td>
    <td style="padding:0;width:250px;"><input type="text" id="as_strasse" autocomplete="off" xreadonly="true" {if $ASConf.strasse.required}required="required"{/if} value="{$AS.strasse|escape}" name="AS[strasse]" class="itxt itxt2col"></td>
  </tr>

  <tr>
    <td style="padding:0;">
      <label for="as_plz" style="display:block;width:auto;">PLZ<span class="right">{if $ASConf.plz.required}<span class="required">*</span>{/if}</span></label></td>
    <td style="padding:0;"><input type="text" id="as_plz" autocomplete="postal code" xreadonly="true" {if $ASConf.plz.required}required="required"{/if} value="{$AS.plz|escape}" name="AS[plz]" class="itxt itxt2col"></td>
  </tr>

  <tr>
    <td style="padding:0;"><label for="ort" style="width:180px;">{$ASConf.ort.label}<span class="right">{if $ASConf.ort.required}<span class="required">*</span>{/if}</span></label></td>
    <td style="padding:0;"><input id="ort" type="text" value="{$AS.ort|escape}" name="AS[ort]" class="itxt itxt2col"></td>
  </tr>


    <tr>
      <td style="padding:0;">
        <label style="display:block;width:auto;">Land<span class="right">{if $ASConf.land.required}<span class="required">*</span>{/if}</span></label></td>
      <td style="padding:0;">
        <select autocomplete="address-level2" name="AS[land]" class="iselect">
          {foreach name="F1" item=IT from=$laenderLst}
          <option value="{$IT}" {if $AS.land == $IT}selected{/if}>{$IT}</option>
          {/foreach}
        </select>
      </td>
    </tr>
{*
  <tr style="display: none">
    <td style="padding:0;"><label for="gebaeude" style="width:180px;">{$ASConf.gebaeude.label}<span class="right">{if $ASConf.gebaeude.required}<span class="required">*</span>{/if}</span></label>
        <input type="hidden" id="gebaeude" value="{$AS.gebaeude|escape}" name="AS[gebaeude]"></td>
    <td style="padding:0;"><input type="text" onclick="get_standort_gebaeude(this, O('gebaeude'))" value="{$AS.gebaeude_text|escape}" name="AS[gebaeude_text]" class="itxt itxt2col"></td>
  </tr>

  <tr>
    <td style="padding:0;"><label for="etage" style="display:block;width:auto;">{$ASConf.etage.label}<span class="right">{if $ASConf.etage.required}<span class="required">*</span>{/if}</span></label>
        <input type="hidden" id="etage" value="{$AS.etage|escape}" {if $ASConf.etage.required}required="required"{/if} name="AS[etage]">
    </td>
    <td style="padding:0;"><input type="text" readonly="true" {if $ASConf.etage.required}required="required"{/if} id="ASEtageUsrInput" onclick="get_gebaeude_etage(this, O('etage'))" value="{$AS.etage|escape}" name="AS[etage_text]" class="itxt itxt2col"></td>
  </tr>

  <tr>
    <td style="padding:0;"><label for="as_raumnr" style="display:block;width:auto;">{$ASConf.raumnr.label}<span class="right">{if $ASConf.raumnr.required}<span class="required">*</span>{/if}</span></label></td>
    <td style="padding:0;"><input type="text" id="as_raumnr" xreadonly="true" {if $ASConf.raumnr.required}required="required"{/if} xonclick="get_standort_raumnr(this)" value="{$AS.raumnr|escape}" name="AS[raumnr]" class="itxt itxt2col"></td>
  </tr>
  <tr>
    <td style="padding:0;"><label for="kostenstelle" style="width:180px;">{$ASConf.kostenstelle.label}<span class="right">{if $ASConf.kostenstelle.required}<span class="required">*</span>{/if}</span></label></td>
    <td style="padding:0;"><input type="text" id="kostenstelle" value="{$AS.kostenstelle|escape}" name="AS[kostenstelle]" class="itxt itxt2col"></td>
  </tr>
  <tr>
    <td style="padding:0;"><label for="planonnr" style="display:block;width:auto;">{$ASConf.planonnr.label}<span class="right">{if $ASConf.planonnr.required}<span class="required">*</span>{/if}</span></label></td>
    <td style="padding:0;"><input id="planonnr" type="text" value="{$AS.planonnr|escape}" name="AS[planonnr]" class="itxt itxt2col"></td>
  </tr>
  
  <tr>
    <td style="padding:0;"><label for="termin" style="width:180px;">Terminwunsch<span class="right">{if $ASConf.terminwunsch.required}<span class="required">*</span>{/if}</span></label></td>
    <td style="padding:0;"><input type="text" value="{$AS.terminwunsch|escape|date_format:"%d.%m.%Y"}" 
	onfocus="showDtPicker(this)" id="terminwunsch" name="AS[terminwunsch]" class="itxt itxt2col jtooltip" rel="%WebRoot%hilfetexte/terminwunsch.php"></td>
  </tr>
	<!-- SelBox_initLSDefault(initInputObj, initLSName, initMultiple, initLSSearchFields, initLSInputFields) -->
  <tr>
    <td style="padding:0;"><label style="width:180px;">Von<span class="right">{if $ASConf.von.required}<span class="required">*</span>{/if}</span></label>
        <input type="hidden" readonly="readonly" id="von_gebaeude_id" value="{$AS.von_gebaeude_id|escape}" name="AS[von_gebaeude_id]">
    </td>
    <td style="padding:0;">
        <input onclick="get_gebaeude(this, O('von_gebaeude_id'))" id="von_gebaeude_text" type="text" value="{$AS.von_gebaeude_text|escape}" readonly="readonly" class="itxt itxt2col">
    </td>
  </tr>
  <tr>
    <td style="padding:0;"><label style="width:180px;">Nach<span class="right">{if $ASConf.nach.required}<span class="required">*</span>{/if}</span></label>
        <input type="hidden" id="nach_gebaeude_id" value="{$AS.nach_gebaeude_id|escape}" name="AS[nach_gebaeude_id]">
    </td>
    <td style="padding:0;">
        <input onclick="get_gebaeude(this, O('nach_gebaeude_id'))" id="nach_gebaeude_text" type="text" value="{$AS.nach_gebaeude_text|escape}" readonly="readonly" class="itxt itxt2col">
    </td>
  </tr>
  *}
</table>
<br>
<div style="margin-top:2rem;"><h2 style="margin:0;">Abweichender Ansprechpartner vor Ort</h2></div>
<table class="form-table" >
  <tr>
    <td style="padding:0;"><label for="ansprechpartner" style="width:180px;">Vor &amp; Nachname:</label></td>
    <td style="padding:0;width:250px;"><input id="ansprechpartner" type="text" value="{$AS.ansprechpartner|escape}" name="AS[ansprechpartner]" class="itxt itxt2col" title="Ansprechpartner"></td>
  </tr>
  <tr>
    <td style="padding:0;"><label for="ansprechpartner_fon" style="width:180px;">Telefon:</label></td>
    <td style="padding:0;"><input id="ansprechpartner_fon" type="text" value="{$AS.ansprechpartner_fon|escape}" name="AS[ansprechpartner_fon]" class="itxt itxt2col jtooltip" rel="%WebRoot%hilfetexte/antrag_fon.php"></td>
  </tr>
</table>
</div>

{if 1}
<div style="float:left; margin-left:50px;">
    {include file="admin_umzugsformular_lieferauswahl.tpl.html"}
</div>
{/if}
</div>
<div style="clear:both;"></div>

{if 0}
    {include file="admin_umzugsformular_mitarbeiterauswahl.tpl.html"}
{/if}

{if 0}
    {include file="admin_umzugsformular_geraeteauswahl.tpl.html"}
{/if}

{if 0}
    {include file="admin_umzugsformular_ortsauswahl.tpl.html"}
{/if}

{if 1}

    {if $AID > 0 and !empty($Reklamationen)}
    {assign var="showReklas" value="1"}
    {else}
    {assign var="showReklas" value="0"}
    {/if}

    {if $AID > 0}
    {assign var="aidExists" value="1"}
    {else}
    {assign var="aidExists" value="0"}
    {/if}
    <div style="margin-top:1.5rem">

      {include file="admin_umzugsformular_leistungsauswahl.tpl.html"
      showLiefermenge="$aidExists"
      showAddLeistung="1"
      showReklas="$showReklas"
      PreiseAnzeigen="$PreiseAnzeigen"
      addTeilmengen="0"
      showTeilmengen="0"
      }
      <div>
      <input type="hidden" name="AS[autocalc_ref_mengen]" value="0">
      <label style="background:none;border:0;width:100%;height:auto;color:black;text-align:left;" for="check_autocalc_ref_mengen">
        <input id="check_autocalc_ref_mengen" {if !empty($AS.autocalc_ref_mengen)}checked{/if} type="checkbox" name="AS[autocalc_ref_mengen]" value="1">
        Mit Katalog-Leistungen verknüpfte Leistungen (Power-Cube, DGUV, Transport, Rabatt) automatisch übernehmen</label>
      </div>
    </div>
{/if}

    {if !empty($Teillieferungen)}
    <div style="margin-top:1.5rem"></div>
    <fieldset><legend><strong>Teil-Lieferungen</strong></legend>
      <div style="padding:5px">
        {include file="admin_umzugsformular_teillieferungen.tpl.html" aItems=$Teillieferungen}
      </div>
    </fieldset>
    {/if}

    {if !empty($Reklamationen)}
    <div style="margin-top:1.5rem"></div>
    <fieldset><legend><strong>Reklamationen</strong></legend>
      <div style="padding:5px">
        {include file="admin_umzugsformular_reklamationen.tpl.html" aReklas=$Reklamationen}
      </div>
    </fieldset>
    {/if}

    {if !empty($aOrderedRHItems)}
    <div style="margin-top:1.5rem"></div>
    <fieldset><legend><strong>Rückholaufträge</strong></legend>
      <div style="padding:5px">
        {include file="admin_ordered_rueckholungen.tpl.html" baseService="aantrag" aItems=$aOrderedRHItems}
      </div>
    </fieldset>
    {/if}

{if !empty($UmzugsAnlagen)}
  {include file="umzugsformular_attachments.tpl.read.html"}
{/if}

{if !empty($UmzugsAnlagenIntern)}
{include file="umzugsformular_attachments.tpl.read2.html" UmzugsAnlagen=$UmzugsAnlagenIntern internal=1}
{/if}

{if !empty($UmzugLieferscheine)}
    <div style="margin-top:1.5rem"></div>
  {include file="umzugsformular_lieferscheine.tpl.read2.html" UmzugsAnlagen=$UmzugLieferscheine internal=1}
{/if}

{if 0}
<div style="width:100%">
    {include file="admin_umzugsformular_gruppierung.tpl.html"}
</div>
{/if}
<!-- <div style="color:#549e1a;font-weight:bold;text-decoration:none;cursor:pointer;" onclick="addMa();return false;">Weiteren Mitarbeiter ausw&auml;hlen <img align="absmiddle" src="images/hinzufuegen_off.png" width="14" alt=""></div><br> -->


  <div id="BoxBemerkungen" style="margin-top: 2rem">
      <strong>Bemerkung hinzufügen:</strong><br>
      <textarea class="iarea bemerkungen" name="AS[bemerkungen]" style="resize: vertical;overflow: auto"></textarea>
  </div>
    {if !empty($AID)}
    <button class='btn blue'
            onclick="umzugsantrag_add_bemerkung()"
            style="cursor: pointer"
            type="button">Bemerkung hinzufügen</button>
    {/if}

{if ($AS.umzugsstatus ne "abgeschlossen" and $AS.umzugsstatus ne "storniert" and $AS.umzugsstatus ne "abgelehnt")
    or !empty($AS.lieferhinweise)}
  <div style="margin-top: 2rem">
    <strong>Lieferhinweis (für Lieferschein):</strong><br>
{if $AS.umzugsstatus ne "abgeschlossen" and $AS.umzugsstatus ne "storniert" and $AS.umzugsstatus ne "abgelehnt"}
    <div id="BoxLieferhinweise">
        <textarea class="iarea bemerkungen lieferhinweise" name="AS[lieferhinweise]" style="resize: vertical;overflow: auto">{$AS.lieferhinweise|escape}</textarea>
{else}
      {$AS.lieferhinweise|escape}
{/if}
    </div>
  </div>
{/if}

<div style="margin-top:1.5rem;width:100%;margin-top:2.5rem;">
  <div>
  <input type="submit" name="CatchDefaultEnterReturnFalse" onclick="return false;" value="" style="display:none;border:0;background:#fff;color:#fff;position:relative;left:-500px;">
    {if empty($AID)}
    <button
            id="btnAngebotSenden"
            type="submit"
            class="btn green"
            title="Angebot senden"
            value="Angeboten">Angebot<br>senden</button>
    {/if}
    {if !empty($AID)}
      <button type="submit" class="btn grey"
             onclick="umzugsantrag_save()"
             title="Speichern ohne Statusänderung.
  Bei neuen Bemerkungen erfolgt eine Benachrichtigungsmail."
              value="Speichern ohne Status">Speichern ohne Status<br>Neue Bemerkung senden</button>

      {if 0}<input type="submit" class="btn blue d-none" style="margin-right:5px;"
             onclick="umzugsantrag_reload()"
             value="Neu laden">
      {/if}

      <button type="submit" class="btn blue" style="float:right;margin-left:5px;"
             onclick="umzugsantrag_add_attachement()"
             title="Diese Dateianhänge sind auch für den Kunden sichtbar">Dokumente<br>öffnen / hochladen</button>

      {if $creator == "mertens"}
      <button
              type="button" class="btn blue" style="float:right;margin-left:5px;"
              onclick="umzugsantrag_add_internal_attachement()"
              title="Diese Dateianhänge sind für den Kunden Nicht sichtbar">Interne Dokumente<br>öffnen / hochladen</button>
      {/if}

      {if $AS.umzugsstatus eq "beantragt" or $AS.umzugsstatus eq "abgeschlossens"}
      <button
              type="button" class="btn blue" style="float:right;margin-left:5px;"
              onclick="umzugsantrag_add_lieferschein()"
              value="Quittierten Lieferschein hinzufügen">Quittierten Lieferschein<br>hinzufügen</button>
      {/if}
    {/if}
  </div>
<br>
{if !empty($AID) and $AS.umzugsstatus ne "temp"}
  <div style="margin-top:2.5rem;"><strong>Status mit Benachrichtung setzen: </strong></div>
  <div class="statusConsole">
  {if $AS.umzugsstatus eq "beantragt" or $AS.umzugsstatus eq "genehmigt"}{*  or $AS.umzugsstatus eq "angeboten" *}
    <button
          id="btnStatGeprBackToUser" type="submit"
          class="{if $AS.umzugsstatus eq 'beantragt' or $AS.umzugsstatus eq 'erneutpruefen' or $AS.umzugsstatus eq 'angeboten'}btn blue{else}cssHide{/if}"
          onclick="umzugsantrag_set_status('zurueckgeben','Ja')"
          value="Zurueckgeben">Zur Bearbeitung an<br>Kunde zurückgeben</button>

    <button
            id="btnStatBestJa"
            type="submit"
            class="btn green"
            onclick="umzugsantrag_set_status('bestaetigt','Ja')"
            title="Senden als Bestätigt"
            value="Avisieren">Auftrag bestätigen <br> Avisierung senden</button>
  {/if}
  {if 0}
    <input
            id="btnStatGenJa" type="submit"
            class="{if $AS.genehmigt_br eq 'Ja' || $AS.bestaetigt ne 'Init'}cssHide{else}btn green{/if}"
            onclick="umzugsantrag_set_status('genehmigt','Ja')"
            title="Bestätigung senden" value="Senden">

    <input
            id="btnStatGenNein" type="submit"
            class="{if $AS.genehmigt_br eq 'Nein' || $AS.bestaetigt ne 'Init'}cssHide{else}btn red{/if}"
            onclick="umzugsantrag_set_status('genehmigt','Nein')"
          value="Ablehnen">
  {/if}
  {if $AS.genehmigt_br eq 'Ja'}
    <input
            id="btnStatGenReset" type="submit"
            class="{if $AS.genehmigt_br eq 'Init' || $AS.bestaetigt ne 'Init'}cssHide{else}btn blue{/if}"
            onclick="umzugsantrag_set_status('genehmigt','Init')"
            value="Genehmigung aufheben">
&nbsp; {/if}
  {if  $AS.umzugsstatus eq 'bestaetigt' or $AS.umzugsstatus eq 'geprueft'}
    <button
            id="btnStatAbgJa" type="submit"
            class="{if $AS.abgeschlossen ne 'Init'}cssHide{else}btn green{/if}"
            onclick="umzugsantrag_set_status('abgeschlossen','Ja')"
            value="Auftrag jetzt abschließen">Auftrag jetzt<br>abschließen</button>
&nbsp; {/if}



  {if  $AS.umzugsstatus eq 'genehmigt' and $user.adminmode eq "superadmin"}
  <button
          id="btnStatGenInit" type="submit" style="float:right;margin-left:5px;"
          class="{if $AS.abgeschlossen ne 'Init'}cssHide{else}btn blue{/if}"
          onclick="umzugsantrag_set_status('genehmigt','Init')"
          value="Genehmigung wieder aufheben">Genehmigung<br>wieder aufheben</button>
  {/if}
  {if  $AS.umzugsstatus eq 'bestaetigt' and $user.adminmode eq "superadmin"}
  <button
          id="btnStatBestInit" type="submit" style="float:right;margin-left:5px;"
          class="{if $AS.abgeschlossen ne 'Init'}cssHide{else}btn red{/if}"
          onclick="umzugsantrag_set_status('bestaetigt','Init')"
          value="Avisierung wieder aufheben">Avisierung<br>wieder aufheben</button>
  {/if}
  {if $user.gruppe eq "admin" and $user.adminmode eq "superadmin"}
  <button id="btnStatAbgReset" type="submit" style="float:rightmargin-left:5px;"
         class="{if $AS.abgeschlossen eq 'Init'}cssHide{else}btn red{/if}"
         onclick="umzugsantrag_set_status('abgeschlossen','Init')"
          value="Abschluss wieder aufheben">Abschluss<br>wieder aufheben</button>

  <button id="btnStatAbgStorno" type="submit" style="float:right;margin-left:5px;"
         class="{if $AS.abgeschlossen ne 'Init'}cssHide{else}btn red{/if}"
         onclick="umzugsantrag_set_status('abgeschlossen','Storniert')"
          value="Auftrag Stornieren">Auftrag<br>Stornieren</button>
  {/if}
    {if $AS.service eq "Ja" && empty($AS.ref_aid) and $AS.umzugsstatus ne "angeboten" and $AS.umzugsstatus ne "temp"}
    <button type="button" class="btn red" id="showReklaDialog">Leistungen<br>reklamieren</button>
    <button type="button" class="btn green" id="showTeillieferungDialog">Teil-Lieferung<br>anlegen</button>
    {/if}
  <div style="display: inline-block;clear: both"></div>
</div>

{/if}
</div>

{if 0}
  {if $AS.umzug eq "Nein"}
    Antrag ist ohne Umzug und kann direkt ausgeführt werden
  {else}
    Antrag ist mit Umzug und erfordert die Genehmigung durch Property
  {/if}
{/if}
<!-- Debug-Btn:
<input type="submit" onclick="return umzugsantrag_submit_debug('speichern')" style="padding:0 0 9px 0;background:url(images/BtnGrey.png) bottom left no-repeat;border:0;width:90px;height:24px;font-size:12px;color:#fff;font-weight:bold;" name="cmd" value="speichern">
<input type="submit" onclick="return umzugsantrag_submit_debug('senden')" style="padding:0 0 9px 0;background:url(images/BtnRed.png) bottom left no-repeat;border:0;width:90px;height:24px;font-size:12px;color:#fff;font-weight:bold;" name="cmd" value="senden">
<input type="submit" onclick="return umzugsantrag_submit_debug('stornieren')" style="padding:0 0 9px 0;background:url(images/BtnRed.png) bottom left no-repeat;border:0;width:90px;height:24px;font-size:12px;color:#fff;font-weight:bold;" name="cmd" value="stornieren">
<input type="submit" onclick="return umzugsantrag_submit_debug('laden')" style="padding:0 0 9px 0;background:url(images/BtnRed.png) bottom left no-repeat;border:0;width:90px;height:24px;font-size:12px;color:#fff;font-weight:bold;" name="cmd" value="laden">
 -->
</form>

</div>
<div id="LoadingBar"></div>
</p>
</div>
{include file="dialogs/rekla_dialog.html"}
{include file="dialogs/teillieferung_dialog.html"}
{include file="dialogs/kundenauswahl_dialog.html"}

{literal}
<script>
  function getAID() {
    return $("input[name=AS\\[aid\\]]").val();
  }

  $(function() {

    $(".cluetip").cluetip({activation: 'click', closePosition: 'title', arrows: true});

    $("#showTeillieferungDialog").on("click", function(e) {
      e.preventDefault();
      showTeillieferungDialog();
      return false;
    });

    $("#showReklaDialog").on("click", function(e) {
      e.preventDefault();
      showReklaDialog();
      return false;
    });

    $("#btnSelectCustomer").on("click", function(e) {
      showKundenauswahlDialog(function(result) {
        console.log("SELECTED USER:\n" + JSON.stringify(result));
        $(":input[name=AS\\[antragsteller_uid\\]]").val(result.uid);
        $(":input[name=AS\\[vorname\\]]").val(result.vorname);
        $(":input[name=AS\\[vorname\\]]").val(result.vorname);
        $(":input[name=AS\\[name\\]]").val(result.nachname);
        $(":input[name=AS\\[email\\]]").val(result.email);
        $(":input[name=AS\\[fon\\]]").val(result.fon);
        $(":input[name=AS\\[personalnr\\]]").val(result.personalnr);
      });
    });

    $("#btnMarkAsRead").bind("click", function(e) {
      var btn = $(this).waitMe();
      var box = $("#neueBemerkungenHintBox");
      var aid = getAID();
      var numGelesen = $(this).data("num");

      var rq = $.get('/bemerkungen_gelesen.php', { aid, numGelesen }, function(responseData) {
        if (typeof responseData === 'object' && 'type' in responseData) {
          if (responseData.type === 'success') {
            box.hide();
            return;
          }
          if (responseData.type === 'error') {
            alert(responseData.error || 'Fehler beim Zurücksetzen des Zählers!');
          }
        }
      });

      rq.always(function() {
        btn.waitMe('hide');
      });

    });

    $("#btnAngebotSenden").bind("click", function(e) {
      e.preventDefault();
      var frm = document.forms["frmUmzugsantrag"];
      frm.action = "umzugsantrag.php";
      var namedArray = getNamedArrayOfForm( frm );
      var error = umzugsantrag_errors(true);
      console.log(Object.keys(namedArray) );
      console.log({namedArray});

      var as_uid = $( frm ).find(":input[name=AS\\[antragsteller_uid\\]]");
      if (as_uid.length && !as_uid.val()) {
        ErrorBox("Bitte wählen Sie erst einen Kunden für das Angebot aus!");
        return;
      }

      var neueAngebote = [];
      var inputAngebote = $(frm).find(".table-leistungen tbody .row.ist-angebot input[name^=L\\[leistung_id\\]\\[]");
      var inputLeistungen = $(frm).find(".table-leistungen tbody .row:not(.ist-angebot) :input[name^=L\\[]");

      inputAngebote.each(function() {
                var tr = $(this).closest("tr");
                var data = tr.data();
                if (!("leistung" in data)) {
                  return
                }
                neueAngebote.push({
                  leistung_id: data.leistung.leistung_id,
                  kategorie_id: data.leistung.kategorie_id,
                  Bezeichnung: data.leistung.Bezeichnung,
                  menge_mertens: data.leistung.menge_mertens,
                  menge2_mertens: data.leistung.menge2_mertens,
                  preis_pro_einheit: data.leistung.preis_pro_einheit,
                });
              });

      if (error) {
        error = "<h4 class=\"hdErr\" style=\"color:#f00;\">Achtung - Antrag konnte nicht gesendet werden!</h4>\n"+error;
        ErrorBox(error);
        return false;
      }

      var url = frm.action;

      var data = $(frm).find(":input[name]:not([name^=L\\[])").serialize();
      data+= '&' + $.param({cmd: 'senden', status: 'angebot'})
      if (inputLeistungen.length) {
        data+= "&" + inputLeistungen.serialize();
      }
      if (neueAngebote.length) {
        data+= "&" + $.param({ NeueAngebote: neueAngebote});
      }
      var onSuccess = function(responseData, textStatus, jqXHR) {
        console.log("AngebotSenden onSuccess response data", { responseData, textStatus });
        if (responseData.type === "success" & responseData.success && responseData.id) {
          window.top.location.href = '?s=aantrag&id=' + responseData.id;
          return;
        }
        alert('Fehler beim Speicher' + "\n" + (responseData.msg || "") + (responseData.error || "") );
      };

      var dataType = 'json';
      console.log({ url, data, dataType });
      // return;
      umzugsantrag_loadingBar('');
      var response = $.post(url, data, onSuccess, dataType);
      response.always(function() {
        console.log("AngebotSenden always()");
        $("#LoadingBar").remove();
      });

      return;
    });

    function xxxx_umzugsantrag_send() {
      if (!document.forms["frmUmzugsantrag"]) return false;
      var namedArray = getNamedArrayOfForm(document.forms["frmUmzugsantrag"]);
      var AntragSenden = true;
      var error = umzugsantrag_errors(AntragSenden);
      var ma = "";
      var InputFields = false;

      if (namedArray["MA[name]"]) {
        for (var i = 0; i < namedArray["MA[name]"].length; i++) {
          InputFields = getUmzugsItemInputFields(namedArray["MA[name]"][i]);
        }
      }

      if (error) {
        error = "<h4 class=\"hdErr\" style=\"color:#f00;\">Achtung - Antrag konnte nicht gesendet werden!</h4>\n"+error;
        ErrorBox(error);
        return false;
      }

      document.forms["frmUmzugsantrag"].action = "umzugsantrag.php";
      frmSerializeGeraete();
      var sData = frmSerialize(document.forms["frmUmzugsantrag"]);
      var selector = "MyInfoBoxTxt";
      umzugsantrag_loadingBar('');
      //alert("Antrag wird zwischengespeichert!\n"+sData);
      frmSerializeGeraete();
      AjaxFormSend(document.forms["frmUmzugsantrag"], selector, "", "cmd=senden", "senden");
    }
  });
</script>
{/literal}


<div style="display:none;">
<table id="MA_SELECT" class="MitarbeierItem">
  <caption style="font-size:11px;padding:0px;height:18px;">
  <div style="float:left;"><strong>Mitarbeiter</strong> <span name="aktionsstatus" style="margin-left:40px;">Aus Stammdaten</span></div>
  <div style="float:right;">[Anzeigen/Bearbeiten] 
  <img name="RaumStatImg" src="" align="absmiddle" style="border:0;" width=16 height=16 title=""><a href="" onclick="show_raum_mitarbeiter(this, 'ziel');return false;">[Raum-Neu: <span class="RaumStatInfo"></span> ]</a> &nbsp; 
  <a href="" onclick="show_raum_mitarbeiter(this,'');return false;">[Raum-Alt]</a> <span onclick="dropMA(this)" style="cursor:pointer;">Aus Umzugsliste löschen <img align="absmiddle" src="images/loeschen_off.png" width="14" alt=""><span></div>
</caption>
  <thead>
  <tr>
    <td class="ColNName">Nachname</td>
    <td class="ColVName">Vorname</td>
    <td class="ColXF" title="Bitte geben Sie bei externen Mitarbeitern die Firma an!">Fremdfirma</td>
	
    <td class="ColAbt">Abtg</td>
	<td class="ColGeb">Geb&auml;ude</td>
    <td class="ColEtg">Etage</td>
    <td class="ColRnr">R-Nr</td>
    <td class="ColAP">AP-Nr</td>
    
    <td class="ColFon">Tel-Nr</td>
    <td class="ColPC">PC-Nr</td>
    <td class="ColIP">Feste IP</td>
  </tr>
  </thead>
  <tbody>
  <tr class="inputRowVon">
	<td class="nn"><input type="hidden" name="MA[mid][]" value=""><!-- 
 	 --><input type="hidden" name="MA[maid][]" value=""><!-- 
	 --><input value="{if !empty($MA)}{$MA.name|escape}{/if}" id="mitarbeiter"  xonclick="get_mitarbeiter(this)"  class="AutoFill UpperCase" type="text" name="MA[name][]"></td>
    <td class="vn"><input value="{if !empty($MA)}{$MA.vorname|escape}{/if}" class="itxt itxt1col UpperCase AutoFill" type="text" name="MA[vorname][]"></td>
	<td class="xf"><input value="{if !empty($MA)}{$MA.extern_firma|escape}{/if}" onclick="get_extern_firma(this)" class="itxt itxt1col AutoFill" size=15 type="text" name="MA[extern_firma][]"></td>
	
	<td class="abt"><input value="{if !empty($MA)}{$MA.abteilung|escape}{/if}" readonly="true" onclick="get_abteilung(this)" class="itxt AutoFill" size=4 type="text" name="MA[abteilung][]"></td>
	<td class="geb"><input  autocomplete="off" value="{if !empty($MA)}{$MA.gebaeude|escape}{/if}" readonly="true" onclick="get_gebaeude(this)" class="itxt itxt1col AutoFill" type="text" name="MA[gebaeude][]"></td>
    <td class="etg"><input value="{if !empty($MA)}{$MA.etage|escape}{/if}" onclick="get_etage(this)" readonly="true" class="itxt AutoFill" type="text" name="MA[etage][]"></td>
    <td class="rnr"><input value="{if !empty($MA)}{$MA.raumnr|escape}{/if}" onclick="get_raumnr(this)" readonly="true" class="itxt AutoFill" size=8 type="text" name="MA[raumnr][]"></td>
    <td class="apnr"><input value="{if !empty($MA)}{$MA.apnr|escape}{/if}" onclick="get_apnr(this)" class="itxt AutoFill" readonly="true" size=8 type="text" name="MA[apnr][]"></td>
    
    <td class="fon"><input value="{if !empty($MA)}{$MA.fon|escape}{/if}" class="itxt" type="text" name="MA[fon][]"></td>
    <td class="pcnr"><input value="{if !empty($MA)}{$MA.pcnr|escape}{/if}" class="itxt" type="text" name="MA[pcnr][]"></td>
    <td class="festeip"><input value="{if !empty($MA)}{$MA.festeip|escape}{/if}" class="itxt" type="text" name="MA[festeip][]"></td>
</tr>
  <tr class="inputRowZiel">
    <td class="ziel" align=right>Anforderungsart</td>
	<td class="uart"><input value="{if !empty($MA)}{$MA.umzugsart|escape}{/if}" class="UserInput" readonly="true" onclick="get_umzugsart(this)" type="text" name="MA[umzugsart][]"></td>
    <td class="ziel" align=right> Nach:</td>
    <td class="etg"><input value="{if !empty($MA)}{$MA.zabteilung|escape}{/if}" readonly="true" onclick="get_abteilung(this)" class="itxt UserInput" type="text" name="MA[zabteilung][]"></td>
	<td class="zort"><input value="{if !empty($MA)}{$MA.zgebaeude|escape}{/if}" readonly="true" onclick="get_gebaeude(this)" class="itxt UserInput" type="text" name="MA[zgebaeude][]"></td>
    <td class="geb"><input value="{if !empty($MA)}{$MA.zetage|escape}{/if}" readonly="true" onclick="get_etage(this)" class="itxt UserInput" type="text" name="MA[zetage][]"></td>
    <td class="rnr"><input value="{if !empty($MA)}{$MA.zraumnr|escape}{/if}" readonly="true" onclick="get_raumnr(this)" class="itxt UserInput" type="text" name="MA[zraumnr][]"></td>
    <td class="rnr"><input value="{if !empty($MA)}{$MA.zapnr|escape}{/if}" class="itxt" type="text" name="MA[zapnr][]"></td>
    <td class="zspace" colspan=3></td>
</tr>
</tbody>
</table>
</div>

<div style="display:none;">
<table id="MA_INPUT" class="MitarbeierItem">
  <caption style="font-size:11px;padding:0px;height:18px;">
  <div style="float:left;"><strong>Mitarbeiter</strong> <span name="aktionsstatus" style="margin-left:40px;color:#f00;">H&auml;ndischer Eintrag!</div>
  <div style="float:right;">[Namen pr&uuml;fen] 
  <img name="RaumStatImg" src="" align="absmiddle" style="border:0;" width=16 height=16 title=""><a href="" onclick="show_raum_mitarbeiter(this, 'ziel');return false;">[Raum-Neu: <span id="RaumStatInfo"></span> ]</a> &nbsp;
  <a href="" onclick="show_raum_mitarbeiter(this,'');return false;">[Raum-Alt]</a> <span onclick="dropMA(this)" style="cursor:pointer;">Aus Anforderungsliste l&ouml;schen <img align="absmiddle" src="images/loeschen_off.png" width="14" alt=""><span></div><div style="clear:both;"></div>
</caption>
  <thead>
  <tr>
    <td class="ColNName">Nachname</td>
    <td class="ColVName">Vorname</td>
    <td class="ColXF" title="Bitte geben Sie bei externen Mitarbeitern die Firma an!">Fremdfirma</td>
	
    <td class="ColAbt">Abtg</td>
	<td class="ColGeb">Geb&auml;ude</td>
    <td class="ColEtg">Etage</td>
    <td class="ColRnr">R-Nr</td>
    <td class="ColAP">AP-Nr</td>
    
    <td class="ColFon">Tel-Nr</td>
    <td class="ColPC">PC-Nr</td>
    <td class="ColIP">Feste IP</td>
  </tr>
  </thead>
  <tbody>
  <tr class="inputRowVon">
	<td class="nn"><input type="hidden" name="MA[mid][]" value=""><!-- 
 	 --><input type="hidden" name="MA[maid][]" value=""><!-- 
	 --><input
            value="{if !empty($MA)}{$MA.name|escape}{/if}"
            id="mitarbeiter" xonclick="get_mitarbeiter(this)"
            class="itxt itxt1col UpperCase UserInput"
            type="text" name="MA[name][]"></td>
    <td class="vn"><input
            value="{if !empty($MA)}{$MA.vorname|escape}{/if}"
            class="itxt itxt1col UpperCase UserInput"
            type="text" name="MA[vorname][]"></td>
	<td class="xf"><input
            value="{if !empty($MA)}{$MA.extern_firma|escape}{/if}"
            onclick="get_extern_firma(this)"
            class="itxt itxt1col UserInput" size=15
            type="text" name="MA[extern_firma][]"></td>
	
	<td class="abt"><input
            value="{if !empty($MA)}{$MA.abteilung|escape}{/if}"
            readonly="true"
            onclick="get_abteilung(this)"
            class="itxt UserInput" size=4
            type="text" name="MA[abteilung][]"></td>
	<td class="geb"><input
            autocomplete="off"
            value="{if !empty($MA)}{$MA.gebaeude|escape}{/if}"
            readonly="true"
            onclick="get_gebaeude(this)"
            class="itxt itxt1col UserInput"
            type="text" name="MA[gebaeude][]"></td>
    <td class="etg"><input
            value="{if !empty($MA)}{$MA.etage|escape}{/if}"
            onclick="get_etage(this)"
            readonly="true"
            class="itxt UserInput"
            type="text" name="MA[etage][]"></td>
    <td class="rnr"><input
            value="{if !empty($MA)}{$MA.raumnr|escape}{/if}"
            onclick="get_raumnr(this)"
            readonly="true"
            class="itxt UserInput" size=8
            type="text" name="MA[raumnr][]"></td>
    <td class="apnr"><input value="{if !empty($MA)}{$MA.apnr|escape}{/if}" class="itxt UserInput" readonly="true" size=8 type="text" name="MA[apnr][]"></td>
    
    <td class="fon"><input value="{if !empty($MA)}{$MA.fon|escape}{/if}" class="itxt" type="text" name="MA[fon][]"></td>
    <td class="pcnr"><input value="{if !empty($MA)}{$MA.pcnr|escape}{/if}" class="itxt" type="text" name="MA[pcnr][]"></td>
    <td class="festeip"><input value="{if !empty($MA)}{$MA.festeip|escape}{/if}" class="itxt" type="text" name="MA[festeip][]"></td>
	</tr>
  <tr class="inputRowZiel">
    <td class="ziel" align=right>Anforderungsart</td>
	<td class="uart"><input value="{if !empty($MA)}{$MA.umzugsart|escape}{/if}" class="UserInput" readonly="true" onclick="get_umzugsart(this)" type="text" name="MA[umzugsart][]"></td>
    <td class="ziel" align=right> Nach:</td>
    <td class="abt"><input value="{if !empty($MA)}{$MA.zabteilung|escape}{/if}" readonly="true" onclick="get_abteilung(this)" class="itxt UserInput" type="text" name="MA[zabteilung][]"></td>
	<td class="geb"><input value="{if !empty($MA)}{$MA.zgebaeude|escape}{/if}" readonly="true" onclick="get_gebaeude(this)" class="itxt UserInput" type="text" name="MA[zgebaeude][]"></td>
    <td class="etg"><input value="{if !empty($MA)}{$MA.zetage|escape}{/if}" readonly="true" onclick="get_etage(this)" class="itxt UserInput" type="text" name="MA[zetage][]"></td>
    <td class="rnr"><input value="{if !empty($MA)}{$MA.zraumnr|escape}{/if}" readonly="true" onclick="get_raumnr(this)" class="itxt UserInput" type="text" name="MA[zraumnr][]"></td>
    <td class="apnr"><input value="{if !empty($MA)}{$MA.zapnr|escape}{/if}" class="itxt UserInput" type="text" name="MA[zapnr][]"></td>
    <td class="zspace" colspan=3></td>
</tr>
</tbody>
</table>
</div>

<div id="SelBoxUart" class="SelBox">
<div style="position:absolute;right:0;"><img align="absmiddle" src="images/loeschen_off.png" style="cursor:pointer" onclick="document.getElementById('SelbBoxUart').style.display='none'" width="14" alt=""></div>
<div class="SelTitle"><strong>Anforderungsarten</strong></div>
<div id="SelBoxUartItems">
<div class="SelItem"><input type="checkbox" name="uartbox" value="Box" checked=1> <strong>Box</strong>move</div>
<div class="SelItem"><input type="checkbox" name="uartbox" value="Mit M?bel" checked=1> Mit <strong>M&ouml;bel</strong></div>
</div>
</div>
